# set variables for compile
CC = gcc
CFLAG =
TARGET_PATH = ../../udas-0.0-0-amd64/usr/bin
TARGET_FILE_UDAS = udas
TARGET_FILE_DETECTOR = udas_detector
TARGET_FILE_LISTENER = udas_listener
TARGET_UDAS = $(TARGET_PATH)/$(TARGET_FILE_UDAS)
TARGET_DETECTOR = $(TARGET_PATH)/$(TARGET_FILE_DETECTOR)
TARGET_LISTENER = $(TARGET_PATH)/$(TARGET_FILE_LISTENER)

SOURCE_COMMON = udas_common.c
SOURCE_UDAS = udas.c
SOURCE_DETECTOR = udas_detector.c
SOURCE_LISTENER = udas_listener.c

# set targets
all: $(TARGET_UDAS) $(TARGET_DETECTOR) $(TARGET_LISTENER)

${TARGET_PATH}: 
	mkdir -p ${TARGET_PATH}

# set compile process
$(TARGET_UDAS): $(SOURCE_COMMON) $(SOURCE_UDAS) | $(TARGET_PATH)
	$(CC) $(CFLAG) $(SOURCE_UDAS) $(SOURCE_COMMON) -o $(TARGET_UDAS) 

$(TARGET_DETECTOR): $(SOURCE_COMMON) $(SOURCE_DETECTOR) | $(TARGET_PATH)
	$(CC) $(CFLAG) $(SOURCE_DETECTOR) $(SOURCE_COMMON) -lusb-1.0 -o $(TARGET_DETECTOR) 

$(TARGET_LISTENER): $(SOURCE_LISTENER) | $(TARGET_PATH)
	$(CC) $(CFLAG) $(SOURCE_LISTENER) -o $(TARGET_LISTENER) 

# make clean.
clean:
	rm -f $(TARGET_UDAS)
	rm -f $(TARGET_DETECTOR)
	rm -rf $(TARGET_LISTENER)
